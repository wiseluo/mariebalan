<style>
    .editcity{ color:#06F; cursor:pointer;}
    .cityls span{  border:#ccc solid 1px; text-align:center; margin-right:10px; padding:5px 11px;}

</style>
<section class="scrollable padder">
    <ul class="breadcrumb no-border no-radius b-b b-light pull-in">
        <li><a href="./"><i class="fa fa-home"></i> 首页</a></li>
        <li><a>系统设置</a></li>
        <li><a >配送方式</a></li>
    </ul>
    <div class="m-b-md">
        <h3 class="m-b-none">配送方式</h3>

    </div>
    <section class="panel panel-default">
        <header class="panel-heading">删除配送方式将无法恢复，请谨慎你的操作！</header>
        <div class="row text-sm wrapper">
            <div class="col-sm-5 m-b-xs">
                <select id="doval" class="input-sm form-control input-s-sm inline">

                    <option value="">操作类型</option>
                    <option value="countrydelss">删除</option>
                    <option value="countryflags">启用</option>
                    <option value="countrycanelflags">禁用</option>
                </select>
                <button id="delcitys" class="btn btn-sm btn-default">执行</button>
            </div>
            <div class="col-sm-3">
                <div class="input-group">
                    <input type="text" class="input-sm form-control" id="wk" value="{$wk}" placeholder="关键词">
                    <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" onClick="window.document.location='/admin/system/countrylist?wk='+$('#wk').val()" type="button">搜索</button>
                    </span> </div>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-striped b-t b-light text-sm">
                <thead>
                <tr>
                    <th width="40"><input type="checkbox"></th>
                    <th width="150">名称</th>
                    <th width="150">计费方式</th>
                    <th width="100">首重</th>
                    <th width="100">续重</th>
                    <th width="50">状态</th>
                    <th width="50">默认</th>
                    <th width="50">操作</th>
                </tr>
                </thead>
                <tbody>
                {foreach name='express' item='rs' key='k'}
                <tr id="citylist{$rs['id']}" class="dbeditcity">
                    <td><input class="cityid" type="checkbox" value="{$rs['id']}"></td>
                    <td class="name">{$rs['name']}</td>
                    <td>{if $rs['type'] == 1}按件计费{else}按重量计费{/if}</td>
                    <td>{$rs['firstprice']}</td>
                    <td>{$rs['secondprice']}</td>
                    <td>{if $rs['state']==1 }启用{else}不启用{/if}</td>
                    <td>{if $rs['isdefault'] == 1}是{else}否{/if}</td>
                    <td>
                        <a href="/admin/express/edit?id={$rs['id']}"  class="btn btn-primary btn-xs"><i class="fa fa-edit"></i></a>
                        <a data-id="{$rs['id']}" class="btn btn-danger btn-xs delcity"><i class="fa fa-trash-o"></i></a>
                    </td>
                </tr>
                {/foreach}
                </tbody>
            </table>
        </div>
        <footer class="panel-footer">
            <div class="row">
                <div class="col-sm-4 hidden-xs">
                    <a class="btn btn-sm btn-success" href="/admin/express/edit">新增</a>
                </div>
                <div class="col-sm-4 text-right text-center-xs">
                    <ul class="pagination pagination-sm m-t-none m-b-none">
                        {$pages}
                    </ul>
                </div>
            </div>
        </footer>
    </section>
</section>

<script language="javascript">
    $(function(){
        $(".delcity").on("click",this,function(){
            if(!confirm('你确定要删除吗？'))return false;
            var id=$(this).attr("data-id");
            $.ajax({
                type:"GET",
                cache:false,
                url:"/admin/system/countrydel?id="+id,
                success: function(data){
                    if(data){
                        alert("删除成功");
                        window.location.reload();
                    }else{
                        alert("删除失败");
                    }
//				if(data=='suss'){
//					$("#citylist"+id).hide();
//				}
                }
            })
        })
        $("#delcitys").on("click",this,function(){
            var doval=$("#doval").val();
            if(doval==''){
                alert('请选择操作类型！');
                return false;
            }
            if(doval=='countrydelss'){
                if(!confirm('你确定要批量删除吗？'))return false;
            }
            var IDS={};
            var i=0;
            $(".cityid").each(function(index, element) {
                if($(this).prop("checked")){
                    i=i+1;
                    IDS[i]=$(this).val();
                }
            });
            if(i==0){
                alert("请选择用户后再操作！");return false;
            }
            $.ajax({
                type:"POST",
                cache:false,
                url:"/admin/system/"+doval,
                data:{IDS:IDS},
                success: function(data){
//                    alert(data);
                    window.location.reload();
//				if(data=='suss'){
//					window.location.reload();
//				}else{
//					alert(data);
//				}
                }
            })
        })

    })

</script>